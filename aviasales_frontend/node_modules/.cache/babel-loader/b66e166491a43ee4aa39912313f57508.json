{"ast":null,"code":"import { all, call, put, takeEvery, takeLatest, delay } from 'redux-saga/effects';\n\nconst apiRequest = () => {\n  let res;\n  x.open(\"GET\", \"https://front-test.beta.aviasales.ru/search\", true);\n\n  x.onload = () => {\n    alert(x.responseText);\n  };\n\n  x.send(null);\n};\n\nfunction* updateApi(data) {\n  while (true) {\n    try {\n      const apiResponse = yield call(apiRequest, {\n        data\n      });\n      return apiResponse;\n    } catch (error) {\n      yield put({\n        type: 'UPDATE_RETRY',\n        error\n      });\n      yield delay(2000);\n    }\n  }\n}\n\nfunction* updateResource({\n  data\n}) {\n  const apiResponse = yield call(updateApi, data);\n  yield put({\n    type: 'UPDATE_SUCCESS',\n    payload: apiResponse.body\n  });\n}\n\nexport function* watchUpdateResource() {\n  yield takeLatest('UPDATE_START', updateResource);\n}\nexport function* helloSaga() {\n  console.log('Hello Sagas!');\n  let x = new XMLHttpRequest();\n\n  const get = () => {\n    x.open(\"GET\", \"https://front-test.beta.aviasales.ru/search\", true);\n\n    x.onload = () => {\n      alert(x.responseText);\n    };\n\n    x.send(null);\n  };\n\n  yield call(get); // yield put({ type: 'DATA_FETCHED' });\n}\nexport function* watchSaga() {\n  yield takeEvery('DATA_FETCHED', helloSaga);\n}\nexport function* rootSaga() {\n  yield all([helloSaga(), watchSaga()]);\n}","map":{"version":3,"sources":["/Users/u18193107/Desktop/test-tasks/aviasales_frontend/src/rootSaga.js"],"names":["all","call","put","takeEvery","takeLatest","delay","apiRequest","res","x","open","onload","alert","responseText","send","updateApi","data","apiResponse","error","type","updateResource","payload","body","watchUpdateResource","helloSaga","console","log","XMLHttpRequest","get","watchSaga","rootSaga"],"mappings":"AAAA,SAASA,GAAT,EAAcC,IAAd,EAAoBC,GAApB,EAAyBC,SAAzB,EAAoCC,UAApC,EAAgDC,KAAhD,QAA6D,oBAA7D;;AAEA,MAAMC,UAAU,GAAG,MAAM;AACvB,MAAIC,GAAJ;AACAC,EAAAA,CAAC,CAACC,IAAF,CAAO,KAAP,EAAc,6CAAd,EAA6D,IAA7D;;AACAD,EAAAA,CAAC,CAACE,MAAF,GAAW,MAAM;AACfC,IAAAA,KAAK,CAACH,CAAC,CAACI,YAAH,CAAL;AACD,GAFD;;AAGAJ,EAAAA,CAAC,CAACK,IAAF,CAAO,IAAP;AACD,CAPD;;AASA,UAAUC,SAAV,CAAoBC,IAApB,EAA0B;AACxB,SAAO,IAAP,EAAa;AACX,QAAI;AACF,YAAMC,WAAW,GAAG,MAAMf,IAAI,CAACK,UAAD,EAAa;AAAES,QAAAA;AAAF,OAAb,CAA9B;AACA,aAAOC,WAAP;AACD,KAHD,CAGE,OAAMC,KAAN,EAAa;AACb,YAAMf,GAAG,CAAC;AACRgB,QAAAA,IAAI,EAAE,cADE;AAERD,QAAAA;AAFQ,OAAD,CAAT;AAIA,YAAMZ,KAAK,CAAC,IAAD,CAAX;AACD;AACF;AACF;;AAED,UAAUc,cAAV,CAAyB;AAAEJ,EAAAA;AAAF,CAAzB,EAAmC;AACjC,QAAMC,WAAW,GAAG,MAAMf,IAAI,CAACa,SAAD,EAAYC,IAAZ,CAA9B;AACA,QAAMb,GAAG,CAAC;AACRgB,IAAAA,IAAI,EAAE,gBADE;AAERE,IAAAA,OAAO,EAAEJ,WAAW,CAACK;AAFb,GAAD,CAAT;AAID;;AAED,OAAO,UAAUC,mBAAV,GAAgC;AACrC,QAAMlB,UAAU,CAAC,cAAD,EAAiBe,cAAjB,CAAhB;AACD;AAED,OAAO,UAAUI,SAAV,GAAsB;AAC3BC,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AAEA,MAAIjB,CAAC,GAAG,IAAIkB,cAAJ,EAAR;;AAEA,QAAMC,GAAG,GAAG,MAAM;AAChBnB,IAAAA,CAAC,CAACC,IAAF,CAAO,KAAP,EAAc,6CAAd,EAA6D,IAA7D;;AACAD,IAAAA,CAAC,CAACE,MAAF,GAAW,MAAM;AACfC,MAAAA,KAAK,CAACH,CAAC,CAACI,YAAH,CAAL;AACD,KAFD;;AAGAJ,IAAAA,CAAC,CAACK,IAAF,CAAO,IAAP;AACD,GAND;;AAQA,QAAMZ,IAAI,CAAC0B,GAAD,CAAV,CAb2B,CAc3B;AACD;AAED,OAAO,UAAUC,SAAV,GAAsB;AAC3B,QAAMzB,SAAS,CAAC,cAAD,EAAiBoB,SAAjB,CAAf;AACD;AAED,OAAO,UAAUM,QAAV,GAAqB;AAC1B,QAAM7B,GAAG,CAAC,CACRuB,SAAS,EADD,EAERK,SAAS,EAFD,CAAD,CAAT;AAID","sourcesContent":["import { all, call, put, takeEvery, takeLatest, delay } from 'redux-saga/effects';\n\nconst apiRequest = () => {\n  let res\n  x.open(\"GET\", \"https://front-test.beta.aviasales.ru/search\", true);\n  x.onload = () => {\n    alert(x.responseText);\n  }\n  x.send(null);\n}\n\nfunction* updateApi(data) {\n  while (true) {\n    try {\n      const apiResponse = yield call(apiRequest, { data });\n      return apiResponse;\n    } catch(error) {\n      yield put({\n        type: 'UPDATE_RETRY',\n        error\n      })\n      yield delay(2000);\n    }\n  }\n}\n\nfunction* updateResource({ data }) {\n  const apiResponse = yield call(updateApi, data);\n  yield put({\n    type: 'UPDATE_SUCCESS',\n    payload: apiResponse.body,\n  });\n}\n\nexport function* watchUpdateResource() {\n  yield takeLatest('UPDATE_START', updateResource);\n}\n\nexport function* helloSaga() {\n  console.log('Hello Sagas!');\n\n  let x = new XMLHttpRequest();\n\n  const get = () => {\n    x.open(\"GET\", \"https://front-test.beta.aviasales.ru/search\", true);\n    x.onload = () => {\n      alert(x.responseText);\n    }\n    x.send(null);\n  }\n\n  yield call(get);\n  // yield put({ type: 'DATA_FETCHED' });\n}\n\nexport function* watchSaga() {\n  yield takeEvery('DATA_FETCHED', helloSaga)\n}\n\nexport function* rootSaga() {\n  yield all([\n    helloSaga(),\n    watchSaga()\n  ])\n}"]},"metadata":{},"sourceType":"module"}